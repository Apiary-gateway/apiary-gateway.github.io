---
import SidebarScrollLayout from '../layouts/SidebarScrollLayout.astro';
import BaseLayout from '../layouts/BaseLayout.astro';
import Introduction from '../content/case-study/introduction.astro';
import Research from '../content/case-study/research.astro';
import Design from '../content/case-study/design.astro';

// Define the structure of your case study content
const headings = [
  {
    id: "introduction",
    title: "Introduction",
    img: "/images/homepage-img1.jpg",
    children: [
      {
        id: "overview",
        title: "Overview",
        img: "/images/homepage-img1.jpg"
      },
      {
        id: "problem-statement",
        title: "Problem Statement",
        img: "/images/homepage-img1.jpg"
      }
    ]
  },
  {
    id: "research",
    title: "Research",
    img: "/images/homepage-img1.jpg",
    children: [
      {
        id: "user-research",
        title: "User Research",
        img: "/images/homepage-img1.jpg"
      },
      {
        id: "market-analysis",
        title: "Market Analysis",
        img: "/images/homepage-img1.jpg"
      }
    ]
  },
  {
    id: "design",
    title: "Design",
    img: "/images/homepage-img1.jpg",
    children: [
      {
        id: "wireframes",
        title: "Wireframes",
        img: "/images/homepage-img1.jpg"
      },
      {
        id: "prototypes",
        title: "Prototypes",
        img: "/images/homepage-img1.jpg"
      }
    ]
  }
];

// Helper: Build child image map
function extractChildImages(children = []) {
  return Object.fromEntries(
    children
      .filter((child) => child.img)
      .map((child) => [child.id, child.img])
  );
}
---

<BaseLayout>
  <SidebarScrollLayout headings={headings}>
    <slot>
      {headings.map(({ id, img, children }) => {
        const childImages = extractChildImages(children);
        return (
          <>
            {id === 'introduction' && <Introduction img={img} childImages={childImages} />}
            {id === 'research' && <Research img={img} childImages={childImages} />}
            {id === 'design' && <Design img={img} childImages={childImages} />}
          </>
        );
      })}
    </slot>
  </SidebarScrollLayout>
</BaseLayout>
